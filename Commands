#1. What are the names of all the countries in the country table?
select country_name from country;

#2. What is the total number of customers in the customers table?
select count(customer_id) as total_number_of_customers from customers;

#3. What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?
select avg(age) from customers
where can_email="yes";

#4. How many orders were made by customers aged 30 or older?
select    count(order_id) as number_of_orders from customers
join orders
on
customers.customer_id=orders.customer_id
where age>=30 or age>30 ;
 

 
 
#5. What is the total revenue generated by each product category?
select category , sum(price) as total_revenue from products
join baskets 
on
products.product_id=baskets.product_id
group by category
order by total_revenue desc;


#6. What is the average price of products in the 'food' category?
select avg(price) as average_price from products
where category="food";
 

select * from orders;
 
#7. How many orders were made in each sales channel (sales_channel column) in the orders table?
select    sales_channel , count(order_id) as number_of_orders from orders
group by sales_channel
order by number_of_orders desc;


#8.What is the date of the latest order made by a customer who can receive marketing emails?
select   max(date_shop) from orders
inner join customers 
on
customers.customer_id=orders.customer_id
where can_email="yes"
limit 1;


#9. What is the name of the country with the highest number of orders?
select country_name , count(order_id) as highest_number_of_orders from country 
join orders 
on
country.country_id=orders.country_id
group by country_name 
order by highest_number_of_orders desc
limit 1;

#10. What is the average age of customers who made orders in the 'vitamins' product category?

select avg(age)  ,  category from customers
join orders
on
customers.customer_id=orders.order_id
join baskets
on
orders.order_id=baskets.order_id
join products
on
baskets.product_id=products.product_id
where category="vitamins"
group by  category;
